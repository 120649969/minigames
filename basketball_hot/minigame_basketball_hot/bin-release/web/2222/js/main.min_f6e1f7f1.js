var __reflect=this&&this.__reflect||function(t,e,a){t.__class__=e,a?a.push(e):a=[e],t.__types__=t.__types__?a.concat(t.__types__):a},__extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);a.prototype=e.prototype,t.prototype=new a},__awaiter=this&&this.__awaiter||function(t,e,a,i){return new(a||(a=Promise))(function(n,l){function s(t){try{o(i.next(t))}catch(e){l(e)}}function _(t){try{o(i["throw"](t))}catch(e){l(e)}}function o(t){t.done?n(t.value):new a(function(e){e(t.value)}).then(s,_)}o((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function a(t){return function(e){return i([t,e])}}function i(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,l&&(s=l[2&a[0]?"return":a[0]?"throw":"next"])&&!(s=s.call(l,a[1])).done)return s;switch(l=0,s&&(a=[0,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,l=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(s=o.trys,!(s=s.length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(i){a=[6,i],l=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var n,l,s,_,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return _={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_},Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(a){switch(a.label){case 0:return[4,this.loadResource()];case 1:return a.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=a.sent(),this.startAnimation(t),[4,platform.login()];case 3:return a.sent(),[4,platform.getUserInfo()];case 4:return e=a.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return a.sent(),[4,this.loadTheme()];case 2:return a.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return a.sent(),this.stage.removeChild(t),[3,5];case 4:return e=a.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,a){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=this.createBitmapByName("bg_jpg");this.addChild(t);var e=this.stage.stageWidth,a=this.stage.stageHeight;t.width=e,t.height=a;var i=new egret.Shape;i.graphics.beginFill(0,.5),i.graphics.drawRect(0,0,e,172),i.graphics.endFill(),i.y=33,this.addChild(i);var n=this.createBitmapByName("egret_icon_png");this.addChild(n),n.x=26,n.y=33;var l=new egret.Shape;l.graphics.lineStyle(2,16777215),l.graphics.moveTo(0,0),l.graphics.lineTo(0,117),l.graphics.endFill(),l.x=172,l.y=61,this.addChild(l);var s=new egret.TextField;s.textColor=16777215,s.width=e-172,s.textAlign="center",s.text="Hello Egret",s.size=24,s.x=172,s.y=80,this.addChild(s);var _=new egret.TextField;this.addChild(_),_.alpha=0,_.width=e-172,_.textAlign=egret.HorizontalAlign.CENTER,_.size=24,_.textColor=16777215,_.x=172,_.y=135,this.textfield=_;var o=new eui.Button;o.label="Click!",o.horizontalCenter=0,o.verticalCenter=0,this.addChild(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,a=RES.getRes(t);return e.texture=a,e},e.prototype.startAnimation=function(t){var e=this,a=new egret.HtmlTextParser,i=t.map(function(t){return a.parse(t)}),n=this.textfield,l=-1,s=function(){l++,l>=i.length&&(l=0);var t=i[l];n.textFlow=t;var a=egret.Tween.get(n);a.to({alpha:1},200),a.wait(2e3),a.to({alpha:0},200),a.call(s,e)};s()},e.prototype.onButtonClick=function(t){var e=new MainScenePanel;this.addChild(e)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,a){function i(i){e.call(a,i,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?i(n):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var HitConst=function(){function t(){}return t.getHitRestitution=function(e){return e==HitType.Floor?t.floor_restitution:e==HitType.Right_Line?t.basket_right_line_restitution:e==HitType.Left_Line?t.basket_left_line_restitution:e==HitType.Board?t.basket_board_restitution:e==HitType.Board_Top?t.basket_board_top_down_restitution:e==HitType.Board_Left_Right?t.basket_board_restitution:1},t.getHitFriction=function(e){return e==HitType.Floor?t.floor_friction:e==HitType.Right_Line?t.basket_right_line_friction:e==HitType.Left_Line?t.basket_left_line_friction:e==HitType.Board?t.basket_board_friction:e==HitType.Board_Top?t.basket_board_friction:e==HitType.Board_Left_Right?t.basket_board_friction:1},t.SwapPoint=function(t,e){var a=t.x,i=t.y;t.x=e.x,t.y=e.y,e.x=a,e.y=i},t.SwapPointXY=function(t,e){var a=e.x,i=t.y,n=t.x,l=e.y;t.x=a,t.y=i,e.x=n,e.y=l},t.floor_restitution=-.7,t.floor_friction=1,t.basket_right_line_restitution=-.5,t.basket_right_line_friction=1,t.basket_left_line_restitution=-.5,t.basket_left_line_friction=1,t.basket_board_restitution=-.2,t.basket_board_friction=1,t.basket_board_top_down_restitution=-.7,t.Factor=8,t.Gravity=9.8,t.Max_Speed_X=6*t.Factor,t.MIN_SPEED_Y=-20*t.Factor,t.PUSH_DOWN_IMPLUSE_Y=-20*t.Factor,t.Frame_Speed_X=0*t.Factor,t.BACK_Gravity=t.Gravity,t.BACK_Max_Speed_X=t.Max_Speed_X,t.BACK_MIN_SPEED_Y=t.MIN_SPEED_Y,t.BACK_PUSH_DOWN_IMPLUSE_Y=t.PUSH_DOWN_IMPLUSE_Y,t.BACK_Frame_Speed_X=t.Frame_Speed_X,t.BACK_floor_restitution=t.floor_restitution,t.BACK_basket_right_line_restitution=t.basket_right_line_restitution,t.BACK_basket_left_line_restitution=t.basket_left_line_restitution,t.BACK_basket_board_restitution=t.basket_board_restitution,t}();__reflect(HitConst.prototype,"HitConst");var HitType;!function(t){t[t.Floor=0]="Floor",t[t.Right_Line=1]="Right_Line",t[t.Left_Line=2]="Left_Line",t[t.Board=3]="Board",t[t.Board_Left_Right=4]="Board_Left_Right",t[t.Board_Top=5]="Board_Top",t[t.None=6]="None"}(HitType||(HitType={}));var HitManager=function(){function t(t){this._isOnFloor=!1,this._hitType=HitType.None,this.mainPanel=t}return t.prototype.IsOnFloor=function(){return this._isOnFloor},t.prototype.GetHitType=function(){return this._hitType},t.prototype.CheckHit=function(){return this._hitType=HitType.None,this.CheckHitFloor()?!0:this.CheckHitRightLine()?!0:this.CheckLeftLine()?!0:this.CheckHitBoard()?!0:void 0},t.prototype.HandleBallHit=function(t,e){var a=HitConst.getHitRestitution(e),i=HitConst.getHitFriction(e),n=new egret.Point(this.mainPanel.basketball_speed_x,this.mainPanel.basketball_speed_y),l=this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height/2),s=this.mainPanel.m_basket_ball.localToGlobal(t.x,t.y),_=new egret.Point(s.x-l.x,s.y-l.y);_.normalize(1);var o=n.x*_.x+n.y*_.y,r=new egret.Point(o*_.x,o*_.y),h=new egret.Point(n.x-r.x,n.y-r.y),m=new egret.Point(a*r.x,a*r.y),b=new egret.Point(i*h.x,i*h.y),p=new egret.Point(m.x+b.x,m.y+b.y);this.mainPanel.basketball_speed_x=p.x,this.mainPanel.basketball_speed_y=p.y},t.prototype.CheckHitFloor=function(){var t=this.mainPanel.m_basket_ball.y;return t>=this.mainPanel.m_floor.y-this.mainPanel.m_basket_ball.height?(this._hitType=HitType.Floor,this._isOnFloor?!0:(this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height),HitType.Floor),Math.abs(this.mainPanel.basketball_speed_y)<=.3&&(this.mainPanel.basketball_speed_y=0,this._isOnFloor=!0),this.mainPanel.HasTouchBegin()&&(this.mainPanel.IsFaceLeft()?this.mainPanel.basketball_speed_x=HitConst.Max_Speed_X*-.5:this.mainPanel.basketball_speed_x=.5*HitConst.Max_Speed_X),!0)):(this._isOnFloor=!1,!1)},t.prototype.CheckHitRightLine=function(){var t=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(0,0,t);var e=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.width,e);var a=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.width/2,a);var i=new egret.Point;this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_right_line.x+this.mainPanel.m_right_line.width,this.mainPanel.m_right_line.y,i);var n=new egret.Point;if(this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_right_line.x,this.mainPanel.m_right_line.y,n),this.mainPanel.IsFaceLeft()||HitConst.SwapPoint(i,i),t.x>i.x)return!1;if(e.x<n.x)return!1;if(e.y<n.y)return!1;if(t.y>n.y)return!1;var l=a.y-n.y,s=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>i.x){if(a.x-i.x>s)return!1}else if(a.x<n.x&&n.x-a.x>s)return!1;if(this._hitType=HitType.Right_Line,a.x>i.x){var _=new egret.Point(a.x-s,n.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Right_Line),!0}if(a.x<n.x){var _=new egret.Point(a.x+s,n.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Right_Line),!0}return this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height),HitType.Right_Line),!0},t.prototype.CheckLeftLine=function(){var t=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(0,0,t);var e=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.width,e);var a=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.width/2,a);var i=new egret.Point;this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_left_line.x+this.mainPanel.m_left_line.width,this.mainPanel.m_left_line.y,i);var n=new egret.Point;if(this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_left_line.x,this.mainPanel.m_left_line.y,n),this.mainPanel.IsFaceLeft()||HitConst.SwapPoint(i,n),t.x>i.x)return!1;if(e.x<n.x)return!1;if(e.y<n.y)return!1;if(t.y>n.y)return!1;var l=a.y-n.y,s=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>i.x){if(a.x-i.x>s)return!1}else if(a.x<n.x&&n.x-a.x>s)return!1;if(this.mainPanel.IsFaceLeft()){if(a.x>i.x){var _=new egret.Point(a.x-s,i.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Left_Line),this._hitType=HitType.Left_Line,!0}}else if(a.x<n.x){var _=new egret.Point(a.x+s,i.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Left_Line),this._hitType=HitType.Left_Line,!0}return!1},t.prototype.CheckHitBoard=function(){var t=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(0,0,t);var e=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.width,e);var a=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.width/2,a);var i=new egret.Point;this.mainPanel.m_board_scope.parent.localToGlobal(this.mainPanel.m_board_scope.x,this.mainPanel.m_board_scope.y,i);var n=new egret.Point;if(this.mainPanel.m_board_scope.parent.localToGlobal(this.mainPanel.m_board_scope.x+this.mainPanel.m_board_scope.width,this.mainPanel.m_board_scope.y+this.mainPanel.m_board_scope.height,n),this.mainPanel.IsFaceLeft()||HitConst.SwapPointXY(i,n),t.x>n.x)return!1;if(e.x<i.x)return!1;if(e.y<i.y)return!1;if(t.y>n.y)return!1;if(a.y>n.y){var l=a.y-n.y,s=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>n.x){if(a.x-n.x>s)return!1}else if(a.x<i.x&&i.x-a.x>s)return!1}else if(a.y<i.y){var l=a.y-i.y,_=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>n.x){if(a.x-n.x>_)return!1}else if(a.x<i.x&&i.x-a.x>_)return!1}if(a.x<i.x||a.x>n.x){var o=a.x>n.x,r=a.y<i.y,h=a.y>n.y;if(r||h){var l=0,m=0;r?(l=a.y-i.y,m=i.y):(l=a.y-n.y,m=n.y);var b=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2)),p=new egret.Point(a.x+b,m);o&&(p.x=a.x-b);var c=new egret.Point;this.mainPanel.m_basket_ball.globalToLocal(p.x,p.y,c),this.HandleBallHit(c,HitType.Board)}else this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.height/2),HitType.Board)}else{var r=a.y<i.y,h=a.y>n.y;r?this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height),HitType.Board):h&&this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,0),HitType.Board)}return this._hitType=HitType.Board,!0},t}();__reflect(HitManager.prototype,"HitManager");var HitManagerMi=function(){function t(t){this._isOnFloor=!1,this._hitType=HitType.None,this.mainPanel=t}return t.prototype.IsOnFloor=function(){return this._isOnFloor},t.prototype.GetHitType=function(){return this._hitType},t.prototype._getLastHitType=function(){return this.mainPanel.GetPlayerBall().getLastHitType()},t.prototype.CheckHit=function(){return this._hitType=HitType.None,this.CheckHitFloor()?!0:this.CheckHitRightLine()?!0:this.CheckLeftLine()?!0:this.CheckHitBoard()?!0:!1},t.prototype.HandleBallHit=function(t,e){var a=HitConst.getHitRestitution(e),i=HitConst.getHitFriction(e),n=new egret.Point(this.mainPanel.basketball_speed_x,this.mainPanel.basketball_speed_y),l=this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height/2),s=this.mainPanel.m_basket_ball.localToGlobal(t.x,t.y),_=new egret.Point(s.x-l.x,s.y-l.y);_.normalize(1);var o=n.x*_.x+n.y*_.y,r=new egret.Point(o*_.x,o*_.y),h=new egret.Point(n.x-r.x,n.y-r.y),m=new egret.Point(a*r.x,a*r.y),b=new egret.Point(i*h.x,i*h.y),p=new egret.Point(m.x+b.x,m.y+b.y);if(e!=HitType.Floor){if(Math.abs(p.x)<1*HitConst.Factor){var c=1;0!=p.x&&(c=p.x/Math.abs(p.x)),p.x=1*HitConst.Factor*c}if(p.y<0&&Math.abs(p.y)<HitConst.Gravity){var y=-1*HitConst.Gravity-2*HitConst.Factor;p.y=y}}this.mainPanel.basketball_speed_x=p.x,this.mainPanel.basketball_speed_y=p.y},t.prototype.CheckHitFloor=function(){var t=this.mainPanel.m_basket_ball.y;return t>=this.mainPanel.m_floor.y-this.mainPanel.m_basket_ball.height?(this._hitType=HitType.Floor,this._isOnFloor?!0:(this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height),HitType.Floor),this.mainPanel.basketball_speed_x=Math.max(this.mainPanel.basketball_speed_x,-1*HitConst.Max_Speed_X),this.mainPanel.basketball_speed_x=Math.min(this.mainPanel.basketball_speed_x,HitConst.Max_Speed_X),Math.abs(this.mainPanel.basketball_speed_y)<=.3*HitConst.Factor&&(this.mainPanel.basketball_speed_y=0,this._isOnFloor=!0),this.mainPanel.HasThisRoundTouch()&&!this.mainPanel.HasGoal()&&(this.mainPanel.IsFaceLeft()?this.mainPanel.basketball_speed_x=-1*HitConst.Max_Speed_X:this.mainPanel.basketball_speed_x=HitConst.Max_Speed_X),this.mainPanel.HasGoal()&&Math.abs(this.mainPanel.basketball_speed_x)<3*HitConst.Factor&&(this.mainPanel.basketball_speed_x=3*HitConst.Factor*this.mainPanel.basketball_speed_x/Math.abs(this.mainPanel.basketball_speed_x)),!0)):(this._isOnFloor=!1,!1)},t.prototype.CheckHitRightLine=function(){var t=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(0,0,t);var e=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.width,e);var a=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.width/2,a);var i=new egret.Point;this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_right_line.x+this.mainPanel.m_right_line.width,this.mainPanel.m_right_line.y,i);var n=new egret.Point;if(this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_right_line.x,this.mainPanel.m_right_line.y,n),this.mainPanel.IsFaceLeft()||HitConst.SwapPoint(i,i),t.x>i.x)return!1;if(e.x<n.x)return!1;if(e.y<n.y)return!1;if(t.y>n.y)return!1;var l=a.y-n.y,s=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>i.x){if(a.x-i.x>s)return!1}else if(a.x<n.x&&n.x-a.x>s)return!1;if(a.x>i.x){var _=new egret.Point(a.x-s,n.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Right_Line),this._hitType=HitType.Right_Line,!0}if(a.x<n.x){var _=new egret.Point(a.x+s,n.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Right_Line),this._hitType=HitType.Right_Line,!0}return this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height),HitType.Right_Line),this._hitType=HitType.Right_Line,!0},t.prototype.CheckLeftLine=function(){var t=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(0,0,t);var e=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.width,e);var a=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.width/2,a);var i=new egret.Point;this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_left_line.x+this.mainPanel.m_left_line.width,this.mainPanel.m_left_line.y,i);var n=new egret.Point;if(this.mainPanel.m_right_line.parent.localToGlobal(this.mainPanel.m_left_line.x,this.mainPanel.m_left_line.y,n),this.mainPanel.IsFaceLeft()||HitConst.SwapPoint(i,n),t.x>i.x)return!1;if(e.x<n.x)return!1;if(e.y<n.y)return!1;if(t.y>n.y)return!1;var l=a.y-n.y,s=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>i.x){if(a.x-i.x>s)return!1}else if(a.x<n.x&&n.x-a.x>s)return!1;if(this.mainPanel.IsFaceLeft()){if(a.x>i.x){var _=new egret.Point(a.x-s,i.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Left_Line),this._hitType=HitType.Left_Line,!0}}else if(a.x<n.x){var _=new egret.Point(a.x+s,i.y),o=new egret.Point;return this.mainPanel.m_basket_ball.globalToLocal(_.x,_.y,o),this.HandleBallHit(o,HitType.Left_Line),this._hitType=HitType.Left_Line,!0}return!1},t.prototype.CheckHitBoard=function(){var t=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(0,0,t);var e=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.width,e);var a=new egret.Point;this.mainPanel.m_basket_ball.localToGlobal(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.width/2,a);var i=new egret.Point;this.mainPanel.m_board_scope.parent.localToGlobal(this.mainPanel.m_board_scope.x,this.mainPanel.m_board_scope.y,i);var n=new egret.Point;if(this.mainPanel.m_board_scope.parent.localToGlobal(this.mainPanel.m_board_scope.x+this.mainPanel.m_board_scope.width,this.mainPanel.m_board_scope.y+this.mainPanel.m_board_scope.height,n),this.mainPanel.IsFaceLeft()||HitConst.SwapPointXY(i,n),t.x>n.x)return!1;if(e.x<i.x)return!1;if(e.y<i.y)return!1;if(t.y>n.y)return!1;if(a.y>n.y){var l=a.y-n.y,s=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>n.x){if(a.x-n.x>s)return!1}else if(a.x<i.x&&i.x-a.x>s)return!1}else if(a.y<i.y){var l=a.y-i.y,_=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2));if(a.x>n.x){if(a.x-n.x>_)return!1}else if(a.x<i.x&&i.x-a.x>_)return!1}var o=a.y<i.y,r=a.y>n.y;if(a.x<i.x||a.x>n.x){var h=a.x>n.x;if(o||r){var l=0,m=0;o?(l=a.y-i.y,m=i.y):(l=a.y-n.y,m=n.y);var b=Math.sqrt(Math.pow(this.mainPanel.m_basket_ball.width/2,2)-Math.pow(l,2)),p=new egret.Point(a.x+b,m);h&&(p.x=a.x-b);var c=new egret.Point;this.mainPanel.m_basket_ball.globalToLocal(p.x,p.y,c),this.HandleBallHit(c,HitType.Board),this._hitType=HitType.Board}else h?this.HandleBallHit(new egret.Point(0,this.mainPanel.m_basket_ball.height/2),HitType.Board_Left_Right):this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width,this.mainPanel.m_basket_ball.height/2),HitType.Board_Left_Right),this._hitType=HitType.Board_Left_Right}else if(o)this._hitType=HitType.Board_Top,this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,this.mainPanel.m_basket_ball.height),HitType.Board_Top);else{if(!r)return!1;this._hitType=HitType.Board_Top,this.HandleBallHit(new egret.Point(this.mainPanel.m_basket_ball.width/2,0),HitType.Board_Top)}return!0},t}();__reflect(HitManagerMi.prototype,"HitManagerMi");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DebugPanel=function(t){function e(){var e=t.call(this)||this;e.skinName="Setting";var a=e;return e.btn_close.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){a.parent.removeChild(a)}.bind(e),e),e.btn_ok.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){var t=parseFloat(a.label_gravity.text);null!=t&&(HitConst.Gravity=t),t=parseFloat(a.label_max_x.text),null!=t&&(HitConst.Max_Speed_X=t),t=parseFloat(a.label_min_y.text),null!=t&&(HitConst.MIN_SPEED_Y=t),t=parseFloat(a.label_impluse_y.text),null!=t&&(HitConst.PUSH_DOWN_IMPLUSE_Y=t),t=parseFloat(a.label_wind.text),null!=t?HitConst.Frame_Speed_X=t:console.log("##new_value####is nil######",t),t=parseFloat(a.label_floor_restitution.text),null!=t&&(HitConst.floor_restitution=t),t=parseFloat(a.label_right_restitution.text),null!=t&&(HitConst.basket_right_line_restitution=t),t=parseFloat(a.label_left_restitution.text),null!=t&&(HitConst.basket_left_line_restitution=t),t=parseFloat(a.label_board_restitution.text),null!=t&&(HitConst.basket_board_restitution=t),a.parent.removeChild(a)}.bind(e),e),e.btn_reset.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){this.label_gravity.text=HitConst.BACK_Gravity.toString(),this.label_max_x.text=HitConst.BACK_Max_Speed_X.toString(),this.label_min_y.text=HitConst.BACK_MIN_SPEED_Y.toString(),this.label_impluse_y.text=HitConst.BACK_PUSH_DOWN_IMPLUSE_Y.toString(),this.label_wind.text=HitConst.BACK_Frame_Speed_X.toString(),this.label_floor_restitution.text=HitConst.BACK_floor_restitution.toString(),this.label_right_restitution.text=HitConst.BACK_basket_right_line_restitution.toString(),this.label_left_restitution.text=HitConst.BACK_basket_left_line_restitution.toString(),this.label_board_restitution.text=HitConst.BACK_basket_board_restitution.toString()}.bind(e),e),e.label_gravity.text=HitConst.Gravity.toString(),e.label_max_x.text=HitConst.Max_Speed_X.toString(),e.label_min_y.text=HitConst.MIN_SPEED_Y.toString(),e.label_impluse_y.text=HitConst.PUSH_DOWN_IMPLUSE_Y.toString(),e.label_wind.text=HitConst.Frame_Speed_X.toString(),e.label_floor_restitution.text=HitConst.floor_restitution.toString(),e.label_right_restitution.text=HitConst.basket_right_line_restitution.toString(),e.label_left_restitution.text=HitConst.basket_left_line_restitution.toString(),e.label_board_restitution.text=HitConst.basket_board_restitution.toString(),e}return __extends(e,t),e}(eui.Component);__reflect(DebugPanel.prototype,"DebugPanel");var MainScenePanel=function(t){function e(){var e=t.call(this)||this;return e.basketball_speed_x=0,e.basketball_speed_y=0,e._current_impluse=new egret.Point,e._isUsingMi=!0,e._auto_enter_next_round=!1,e._is_first_round=!0,e._hasTouchBegin=!1,e._hasThisRoundTouch=!1,e._is_face_left=!0,e._has_goal=!1,e.skinName="MainScene",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.m_container.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this);var e=this;this.btn_debug.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){var a=new DebugPanel;e.addChild(a),t.stopPropagation()}.bind(this),this),this.initGame()},e.prototype.HasTouchBegin=function(){return this._hasTouchBegin},e.prototype.getHitManager=function(){return this._hitManager},e.prototype.getHitManagerMi=function(){return this._hitManagerMi},e.prototype.HasThisRoundTouch=function(){return this._hasThisRoundTouch},e.prototype.initGame=function(){this._hitManager=new HitManager(this),this._playerBall=new PlayerBall(this.m_basket_ball,this),this._hitManagerMi=new HitManagerMi(this),this._playerBallMi=new PlayerBallMi(this.m_basket_ball,this),this._left_basket_container_x=this.m_basket_container.x,this._left_basket_container_y=this.m_basket_container.y,this._right_basket_container_x=this.stage.stageWidth,this._right_basket_container_y=this._left_basket_container_y,this.NextRound()},e.prototype.IsFaceLeft=function(){return this._is_face_left},e.prototype.HasGoal=function(){return this._has_goal},e.prototype.SetGoal=function(t){this._has_goal=t},e.prototype.AutoEnterNextRound=function(){this._auto_enter_next_round=!0},e.prototype.IsInAutoEnterNextRound=function(){return this._auto_enter_next_round},e.prototype.GetPlayerBall=function(){return this._playerBallMi},e.prototype.NextRound=function(){if(this.SetGoal(!1),this._is_face_left=0==Math.floor(2*Math.random()),this._is_first_round&&(this._is_face_left=!0),this._hasThisRoundTouch=!1,this._is_face_left?(this.m_basket_container.x=this._left_basket_container_x,this.m_basket_container.y=this._left_basket_container_y,this.m_basket_container.scaleX=Math.abs(this.m_basket_container.scaleX)):(this.m_basket_container.x=this._right_basket_container_x,this.m_basket_container.y=this._right_basket_container_y,this.m_basket_container.scaleX=-1*Math.abs(this.m_basket_container.scaleX)),this._is_first_round){var t=this.stage.stageWidth/2-this.m_basket_ball.width/2,e=this.m_floor.y-200;this.m_basket_ball.x=t,this.m_basket_ball.y=e}this._is_first_round=!1,this._isUsingMi?this._playerBallMi.EnterNextRound():this._playerBall.EnterNextRound()},e.prototype.onEnterFrame=function(t){this._auto_enter_next_round&&(this.NextRound(),this._auto_enter_next_round=!1),this._isUsingMi?this._playerBallMi.Update():this._playerBall.Update()},e.prototype.onTouchBegin=function(t){this._hasTouchBegin||(this._hasTouchBegin=!0),this._hasThisRoundTouch=!0,this.m_basket_ball.y<=this.m_top.y||(this.basketball_speed_y>0&&(this.basketball_speed_y=0),this._current_impluse.y=HitConst.PUSH_DOWN_IMPLUSE_Y,this.basketball_speed_x=HitConst.Max_Speed_X*(this._is_face_left?-1:1))},e.prototype.isLeft=function(){return!0},e}(eui.Component);__reflect(MainScenePanel.prototype,"MainScenePanel");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var PlayerBall=function(){function t(t,e){this._tweenDir=0,this._last_x=0,this._last_y=0,this._rotate_time=.8,this._last_hit_type=HitType.None,this._is_new_round=!1,this.m_basket_ball=t,this.mainPanel=e,this._hitManagerNew=e.getHitManager()}return t.prototype._updateRotationTween=function(){return this.mainPanel.HasTouchBegin()?0==this._tweenDir?void(this.mainPanel.basketball_speed_x<0?(egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:-180},1e3*this._rotate_time).to({rotation:-360},1e3*this._rotate_time),this._tweenDir=-1):(egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:180},1e3*this._rotate_time).to({rotation:360},1e3*this._rotate_time),this._tweenDir=1)):void(this.mainPanel.basketball_speed_x<0&&this._tweenDir>0?(this.mainPanel.m_image_ball.rotation=0,this._tweenDir=-1,egret.Tween.removeTweens(this.mainPanel.m_image_ball),egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:-180},1e3*this._rotate_time).to({rotation:-360},1e3*this._rotate_time)):this.mainPanel.basketball_speed_x>0&&this._tweenDir<0&&(this._tweenDir=1,this.mainPanel.m_image_ball.rotation=0,egret.Tween.removeTweens(this.mainPanel.m_image_ball),egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:180},1e3*this._rotate_time).to({rotation:360},1e3*this._rotate_time))):void 0},t.prototype._adjustBallPosition=function(){var t=!1,e=0;this.mainPanel.m_basket_ball.x<0-this.mainPanel.m_basket_ball.width?(e=this.mainPanel.m_basket_ball.x+this.mainPanel.stage.stageWidth,t=!0):this.mainPanel.m_basket_ball.x>this.mainPanel.stage.stageWidth&&(e=this.mainPanel.m_basket_ball.x-this.mainPanel.stage.stageWidth,t=!0),t&&(this.mainPanel.HasGoal()?this.mainPanel.AutoEnterNextRound():this.mainPanel.m_basket_ball.x=e)},t.prototype._adjustSpeed=function(){this.mainPanel.HasTouchBegin()&&(this.mainPanel.IsFaceLeft()?(this.mainPanel.basketball_speed_x>-1*HitConst.Max_Speed_X&&(this.mainPanel.basketball_speed_x-=HitConst.Frame_Speed_X),this.mainPanel.basketball_speed_x=Math.max(this.mainPanel.basketball_speed_x,-1*HitConst.Max_Speed_X)):(this.mainPanel.basketball_speed_x<HitConst.Max_Speed_X&&(this.mainPanel.basketball_speed_x+=HitConst.Frame_Speed_X),this.mainPanel.basketball_speed_x=Math.min(this.mainPanel.basketball_speed_x,HitConst.Max_Speed_X)))},t.prototype._checkGoal=function(t,e){var a=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x,this.mainPanel.m_circle_scope.y),i=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x+this.mainPanel.m_circle_scope.width,this.mainPanel.m_circle_scope.y+this.mainPanel.m_circle_scope.height);this.mainPanel.IsFaceLeft()||HitConst.SwapPointXY(a,i);var n=this.mainPanel.m_basket_ball.parent.localToGlobal(t.x,t.y),l=this.mainPanel.m_basket_ball.parent.localToGlobal(t.x+this.m_basket_ball.width,t.y+this.m_basket_ball.height),s=new egret.Point((n.x+l.x)/2,(n.y+l.y)/2);if(this._last_x=this.m_basket_ball.x,this._last_y=this.m_basket_ball.y,n.x<a.x-10||l.x>i.x+10)return!1;var _=this.mainPanel.m_basket_ball.parent.localToGlobal(e.x,e.y),o=this.mainPanel.m_basket_ball.parent.localToGlobal(e.x+this.m_basket_ball.width,e.y+this.m_basket_ball.height),r=new egret.Point((_.x+o.x)/2,(_.y+o.y)/2);if(_.x<a.x-10||o.x>i.x+10)return!1;var h=new egret.Point((a.x+i.x)/2,(a.y+i.y)/2);return s.y<=h.y&&r.y>=h.y?(console.log("#########进球了###"),!0):!1},t.prototype._isCurrentInCricleScope=function(){var t=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x,this.mainPanel.m_circle_scope.y),e=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x+this.mainPanel.m_circle_scope.width,this.mainPanel.m_circle_scope.y+this.mainPanel.m_circle_scope.height);
this.mainPanel.IsFaceLeft()||HitConst.SwapPointXY(t,e);var a=this.mainPanel.m_basket_ball.parent.localToGlobal(this.m_basket_ball.x,this.m_basket_ball.y),i=this.mainPanel.m_basket_ball.parent.localToGlobal(this.m_basket_ball.x+this.m_basket_ball.width,this.m_basket_ball.y+this.m_basket_ball.height);return a.x<t.x-10||i.x>e.x+10?!1:!0},t.prototype.EnterNextRound=function(){this._is_new_round=!0},t.prototype.Update=function(){this._adjustSpeed(),this._updateRotationTween(),this._is_new_round&&this.mainPanel.m_basket_ball.x>0&&this.mainPanel.m_basket_ball.x<this.mainPanel.stage.stageWidth&&(this._is_new_round=!1),this._is_new_round||this.mainPanel.IsInAutoEnterNextRound()||this._adjustBallPosition();var t=HitConst.Gravity+this.mainPanel._current_impluse.y;this.mainPanel.basketball_speed_y+=t,this.mainPanel.basketball_speed_y=Math.max(this.mainPanel.basketball_speed_y,-20),this.mainPanel._current_impluse.y=0;for(var e=Math.sqrt(Math.pow(this.mainPanel.basketball_speed_x,2)+Math.pow(this.mainPanel.basketball_speed_y,2)),a=2,i=Math.ceil(e/a),n=this.mainPanel.basketball_speed_x/i,l=this.mainPanel.basketball_speed_y/i,s=this._isCurrentInCricleScope(),_=this.mainPanel.HasGoal(),o=1;i>=o;o++){o==i&&(n=this.mainPanel.basketball_speed_x-this.mainPanel.basketball_speed_x/i*(i-1),l=this.mainPanel.basketball_speed_y-this.mainPanel.basketball_speed_y/i*(i-1));var r=this.m_basket_ball.x,h=this.m_basket_ball.y;if(this.m_basket_ball.x+=n,this.m_basket_ball.y+=l,this.m_basket_ball.y=Math.min(this.m_basket_ball.y,this.mainPanel.m_floor.y-this.m_basket_ball.height),this._hitManagerNew.CheckHit()){this.m_basket_ball.x=r,this.m_basket_ball.y=h;break}s&&(_||(_=this._checkGoal(new egret.Point(r,h),new egret.Point(this.m_basket_ball.x,this.m_basket_ball.y)),_&&this.mainPanel.SetGoal(!0)))}this._hitManagerNew.GetHitType()==HitType.Floor?this.m_basket_ball.x+=this.mainPanel.basketball_speed_x:this._hitManagerNew.GetHitType()!=HitType.None&&this._hitManagerNew.GetHitType()==this._last_hit_type&&(Math.abs(this.mainPanel.basketball_speed_y)<5?this.mainPanel.basketball_speed_y=this.mainPanel.basketball_speed_y/Math.abs(this.mainPanel.basketball_speed_y)*5*-1:Math.abs(this.mainPanel.basketball_speed_y)>10?this.mainPanel.basketball_speed_y=this.mainPanel.basketball_speed_y/Math.abs(this.mainPanel.basketball_speed_y)*10*-1:this.mainPanel.basketball_speed_y=-1*this.mainPanel.basketball_speed_y,console.log("####连续碰撞#####",this.mainPanel.basketball_speed_y)),this._last_hit_type=this._hitManagerNew.GetHitType()},t}();__reflect(PlayerBall.prototype,"PlayerBall");var PlayerBallMi=function(){function t(t,e){this._tweenDir=0,this._last_x=0,this._last_y=0,this._rotate_time=.8,this._last_hit_type=HitType.None,this.m_basket_ball=t,this.mainPanel=e,this._hitManager=e.getHitManagerMi()}return t.prototype._updateRotationTween=function(){return this.mainPanel.HasTouchBegin()?0==this._tweenDir?void(this.mainPanel.basketball_speed_x<0?(egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:-180},1e3*this._rotate_time).to({rotation:-360},1e3*this._rotate_time),this._tweenDir=-1):(egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:180},1e3*this._rotate_time).to({rotation:360},1e3*this._rotate_time),this._tweenDir=1)):void(this.mainPanel.basketball_speed_x<0&&this._tweenDir>0?(this.mainPanel.m_image_ball.rotation=0,this._tweenDir=-1,egret.Tween.removeTweens(this.mainPanel.m_image_ball),egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:-180},1e3*this._rotate_time).to({rotation:-360},1e3*this._rotate_time)):this.mainPanel.basketball_speed_x>0&&this._tweenDir<0&&(this._tweenDir=1,this.mainPanel.m_image_ball.rotation=0,egret.Tween.removeTweens(this.mainPanel.m_image_ball),egret.Tween.get(this.mainPanel.m_image_ball,{loop:!0}).to({rotation:180},1e3*this._rotate_time).to({rotation:360},1e3*this._rotate_time))):void 0},t.prototype._adjustBallPosition=function(){var t=!1,e=0;this.mainPanel.m_basket_ball.x<0-this.mainPanel.m_basket_ball.width?(e=this.mainPanel.m_basket_ball.x+this.mainPanel.stage.stageWidth,t=!0):this.mainPanel.m_basket_ball.x>this.mainPanel.stage.stageWidth&&(e=this.mainPanel.m_basket_ball.x-this.mainPanel.stage.stageWidth,t=!0),t&&(this.mainPanel.m_basket_ball.x=e,this.mainPanel.HasGoal()&&(this.mainPanel.m_basket_ball.y=this.mainPanel.m_floor.y-this.mainPanel.m_basket_ball.height-50-50*Math.random(),this.mainPanel.AutoEnterNextRound()))},t.prototype._adjustSpeed=function(){this.mainPanel.HasThisRoundTouch()&&!this.mainPanel.HasGoal()&&(this.mainPanel.IsFaceLeft()?(this.mainPanel.basketball_speed_x>-1*HitConst.Max_Speed_X&&(this.mainPanel.basketball_speed_x-=HitConst.Frame_Speed_X),this.mainPanel.basketball_speed_x=Math.max(this.mainPanel.basketball_speed_x,-1*HitConst.Max_Speed_X)):(this.mainPanel.basketball_speed_x<HitConst.Max_Speed_X&&(this.mainPanel.basketball_speed_x+=HitConst.Frame_Speed_X),this.mainPanel.basketball_speed_x=Math.min(this.mainPanel.basketball_speed_x,HitConst.Max_Speed_X)))},t.prototype._checkGoal=function(t,e){var a=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x,this.mainPanel.m_circle_scope.y),i=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x+this.mainPanel.m_circle_scope.width,this.mainPanel.m_circle_scope.y+this.mainPanel.m_circle_scope.height);this.mainPanel.IsFaceLeft()||HitConst.SwapPointXY(a,i);var n=this.mainPanel.m_basket_ball.parent.localToGlobal(t.x,t.y),l=this.mainPanel.m_basket_ball.parent.localToGlobal(t.x+this.m_basket_ball.width,t.y+this.m_basket_ball.height),s=new egret.Point((n.x+l.x)/2,(n.y+l.y)/2);if(this._last_x=this.m_basket_ball.x,this._last_y=this.m_basket_ball.y,n.x<a.x-10||l.x>i.x+10)return!1;var _=this.mainPanel.m_basket_ball.parent.localToGlobal(e.x,e.y),o=this.mainPanel.m_basket_ball.parent.localToGlobal(e.x+this.m_basket_ball.width,e.y+this.m_basket_ball.height),r=new egret.Point((_.x+o.x)/2,(_.y+o.y)/2);if(_.x<a.x-10||o.x>i.x+10)return!1;var h=new egret.Point((a.x+i.x)/2,(a.y+i.y)/2);return s.y<=h.y&&r.y>=h.y?(console.log("#########进球了###"),!0):!1},t.prototype._isCurrentInCricleScope=function(){var t=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x,this.mainPanel.m_circle_scope.y),e=this.mainPanel.m_circle_scope.parent.localToGlobal(this.mainPanel.m_circle_scope.x+this.mainPanel.m_circle_scope.width,this.mainPanel.m_circle_scope.y+this.mainPanel.m_circle_scope.height);this.mainPanel.IsFaceLeft()||HitConst.SwapPointXY(t,e);var a=this.mainPanel.m_basket_ball.parent.localToGlobal(this.m_basket_ball.x,this.m_basket_ball.y),i=this.mainPanel.m_basket_ball.parent.localToGlobal(this.m_basket_ball.x+this.m_basket_ball.width,this.m_basket_ball.y+this.m_basket_ball.height);return a.x<t.x-10||i.x>e.x+10?!1:!0},t.prototype.EnterNextRound=function(){},t.prototype.Update=function(){this._adjustSpeed(),this._updateRotationTween(),this._adjustBallPosition();var t=HitConst.Gravity+this.mainPanel._current_impluse.y;this.mainPanel.basketball_speed_y+=t,this.mainPanel.basketball_speed_y=Math.max(this.mainPanel.basketball_speed_y,HitConst.MIN_SPEED_Y),this.mainPanel._current_impluse.y=0;for(var e=Math.sqrt(Math.pow(this.mainPanel.basketball_speed_x,2)+Math.pow(this.mainPanel.basketball_speed_y,2))/HitConst.Factor,a=2,i=Math.ceil(e/a),n=this.mainPanel.basketball_speed_x/i,l=this.mainPanel.basketball_speed_y/i,s=this._isCurrentInCricleScope(),_=this.mainPanel.HasGoal(),o=1;i>=o;o++){o==i&&(n=this.mainPanel.basketball_speed_x-this.mainPanel.basketball_speed_x/i*(i-1),l=this.mainPanel.basketball_speed_y-this.mainPanel.basketball_speed_y/i*(i-1));var r=this.m_basket_ball.x,h=this.m_basket_ball.y;this.m_basket_ball.x+=n/HitConst.Factor,this.m_basket_ball.y+=l/HitConst.Factor;var m=this._hitManager.CheckHit();if(m){if(this.m_basket_ball.x=r,this.m_basket_ball.y=h,this._hitManager.GetHitType()!=HitType.Floor){var b=(this._hitManager.GetHitType(),(i-o)/i),p=Math.sqrt(Math.pow(this.mainPanel.basketball_speed_x,2)+Math.pow(this.mainPanel.basketball_speed_y,2))/HitConst.Factor;0==b&&(b=1),p*=b;var c=Math.min(p,5),y=this.mainPanel.basketball_speed_x*b/HitConst.Factor*c/p,P=this.mainPanel.basketball_speed_y*b/HitConst.Factor*c/p;this.m_basket_ball.x+=y,this.m_basket_ball.y+=P}break}s&&(_||(_=this._checkGoal(new egret.Point(r,h),new egret.Point(this.m_basket_ball.x,this.m_basket_ball.y)),_&&this.mainPanel.SetGoal(!0)))}this._hitManager.GetHitType()==HitType.Floor&&(this.m_basket_ball.x+=this.mainPanel.basketball_speed_x/HitConst.Factor),this._last_hit_type=this._hitManager.GetHitType()},t.prototype.getLastHitType=function(){return this._last_hit_type},t}();__reflect(PlayerBallMi.prototype,"PlayerBallMi");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,a,i){function n(t){e.call(i,t)}function l(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,l,null),a.call(i))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,a){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var _=t.split("/");_.pop();var o=_.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(i,generateJSON.paths[t])},this):RES.getResByUrl(o,function(a){window.JSONParseClass.setData(a),egret.callLater(function(){e.call(i,generateJSON.paths[t])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,l,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);